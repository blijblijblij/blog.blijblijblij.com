<!doctype html><html xmlns=http://www.w3.org/1999/xhtml lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Running pentaho on mesos - part 1 | blog.blijblijblij.com</title><meta property="og:title" content="Running pentaho on mesos - part 1 - blog.blijblijblij.com"><meta property="og:description" content="Introduction I have been amazed by the ease of getting software through the software development cycle once you start doing it the Docker way. I picked it up soon after it came to light, and hammered it hard. At that point I got all developers aligned to use Docker as well.
As we started using Docker more extensively, combining different Frontends services and Backends services through Docker compositions, running multiple hosts, intranet, things started to get a bit more complicated."><meta property="og:url" content="https://blog.blijblijblij.com/posts/pentaho-and-mesos/"><meta property="og:site_name" content="blog.blijblijblij.com"><meta property="og:type" content="article"><meta property="og:image" content="https://blog.blijblijblij.com/images/cover.jpg"><meta property="article:published_time" content="2016-05-21T11:06:05&#43;02:00"><meta property="article:modified_time" content="2016-05-21T11:06:05&#43;02:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@blijblijblij"><meta name=twitter:creator content="@blijblijblij"><link href=https://blog.blijblijblij.com/index.xml rel=alternate type=application/rss+xml title=blog.blijblijblij.com><link rel=stylesheet href=/css/style.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://blog.blijblijblij.com/posts/pentaho-and-mesos/><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"></head><body><section class=section><div class=container><nav id=nav-main class=nav><div id=nav-name class=nav-left><a id=nav-anchor class=nav-item href=https://blog.blijblijblij.com/><h1 id=nav-heading class="title is-4">blog.blijblijblij.com</h1></a></div><div class=nav-right><nav id=nav-items class="nav-item level is-mobile"><a class=level-item aria-label=github href=https://github.com/blijblijblij target=_blank rel=noopener><span class=icon><i><svg viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0 0 20 4.77 5.07 5.07.0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38.0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 0 0 5 4.77a5.44 5.44.0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 0 0 9 18.13V22"/></svg></i></span></a><a class=level-item aria-label=twitter href=https://twitter.com/blijblijblij target=_blank rel=noopener><span class=icon><i><svg viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M23 3a10.9 10.9.0 0 1-3.14 1.53 4.48 4.48.0 0 0-7.86 3v1A10.66 10.66.0 0 1 3 4s-4 9 5 13a11.64 11.64.0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5.0 0 0-.08-.83A7.72 7.72.0 0 0 23 3z"/></svg></i></span></a><a class=level-item aria-label=instagram href=https://instagram.com/blijblijblij target=_blank rel=noopener><span class=icon><i><svg viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"/></svg></i></span></a><a class=level-item aria-label=email href=mailto:rogier@blijblijblij.com target=_blank rel=noopener><span class=icon><i><svg viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></i></span></a><a class=level-item aria-label=linkedin href=https://linkedin.com/in/blijblijblij target=_blank rel=noopener><span class=icon><i><svg viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path stroke-width="1.8" d="m5.839218 4.101561c0 1.211972-.974141 2.194011-2.176459 2.194011S1.4863 5.313533 1.4863 4.101561c0-1.211094.974141-2.194011 2.176459-2.194011s2.176459.982917 2.176459 2.194011zm.017552 3.94922h-4.388022v14.04167H5.85677V8.050781zm7.005038.0H8.501869v14.04167h4.360816v-7.370999c0-4.098413 5.291077-4.433657 5.291077.0v7.370999h4.377491v-8.89101c0-6.915523-7.829986-6.66365-9.669445-3.259423V8.050781z"/></svg></i></span></a></nav></div></nav><nav class=nav></nav></div><script src=/js/navicon-shift.js></script></section><section class=section><div class=container><div class="subtitle tags is-6 is-pulled-right"><a class="subtitle is-6" href=/tags/mesos>#mesos</a>
| <a class="subtitle is-6" href=/tags/pentaho>#pentaho</a></div><h2 class="subtitle is-6">May 21, 2016</h2><h1 class=title>Running pentaho on mesos - part 1</h1><div class=content><h1 id=introduction>Introduction</h1><p>I have been amazed by the ease of getting software through the software development cycle once you start doing it the <a href=https://www.docker.com/>Docker</a> way. I picked it up soon after <a href=http://www.wired.com/2013/09/docker/>it came to light</a>, and hammered it hard. At that point I got all developers aligned to use Docker as well.</p><p>As we started using Docker more extensively, combining different Frontends services and Backends services through Docker compositions, running multiple hosts, intranet, things started to get a bit more complicated.</p><p><a href=https://twitter.com/adrianmouat>Adrian Mouat</a> acknowledged my next step in a piece he wrote for Oreilly <a href=https://www.oreilly.com/ideas/swarm-v-fleet-v-kubernetes-v-mesos>Swarm v. Fleet v. Kubernetes v. Mesos Comparing different orchestration tools</a> my prefered orchestration framework for our containers would be Mesos.</p><h1 id=define>Define</h1><p>This is an overview of a mesos cluster in its simplest form.
<img src=https://raw.githubusercontent.com/blijblijblij/blog.blijblijblij.com-hugo/9dafdf22f19d04c63eb47e2c9681884694887156/static/images/mesos-arch.png alt="Mesos architectural overview">
<a href=https://www.oreilly.com/ideas/swarm-v-fleet-v-kubernetes-v-mesos>Source</a></p><ul><li><strong>The mesos-master</strong> is the central part of the cluster, it controls all jobs on the cluster. Usually multiple masters are running on a cluster, thereby given it HA capabilities, especially when running the masters in different <a href=http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#concepts-regions-availability-zones>availability zones</a>.</li><li><strong>The marathon scheduler</strong> is the scheduler for long running processes, a webserver, a carte server, a baserver, &hellip; The functionality of Marathon on the cluster is often compared to what <code>init.d</code> leverages on a linux system. To run services, keep them running, scale them etc.</li><li><strong>The chronos scheduler</strong> is a scheduler batch task, and as such often compared to <code>cron</code></li><li><strong>The mesos slaves aka agents</strong> run the actual jobs as directed by the mesos master(s)</li><li><strong>Zookeeper</strong> is used for master elections, coordination and to persist configuration throughout the cluster.</li></ul><p>There is so much more to be told about mesos, but I suggest you just <code>Run, Forrest, Run!</code> to <a href="http://ssearch.oreilly.com/?q=mesos&amp;x=0&amp;y=0">Oreilly</a>, <a href=https://www.manning.com/books/mesos-in-action>Manning</a> or some other it-drug delivery service and read up on this topic.</p><h1 id=create>Create</h1><p>I am going to assume a working <a href=https://docs.docker.com/engine/installation/>docker</a> / <a href=https://docs.docker.com/compose/install/>docker-compose</a> / <a href=https://docs.docker.com/machine/install-machine/>docker-machine</a> setup, some recent hardware.</p><p>For now I will focus on a virtualbox based cluster running locally. I have created a crude but usefull bash-script to get you up and running, it cleans, creates masters, slave and a loadbalancer by utilising docker-machine. I have 4cpu, 16G of RAM at my disposal, just tinker with <code>virtualbox-cpu-count</code>, <code>virtualbox-memory</code> and <code>virtualbox-disk-size</code> to make this baby fit your needs.</p><pre><code>#!/bin/sh
clear

echo &quot;creating my epic local cluster&quot;

clean() {
  echo &quot;---&gt; rm old machines, no mercy baby!&quot;
  docker-machine rm -f mesos-lb1 mesos-m1 mesos-m2 mesos-m3 mesos-s1 mesos-s2 &gt; /dev/null
}

create_masters() {
  echo &quot;---&gt; create masters&quot;
  echo &quot;---&gt; create mesos-m1&quot;
  docker-machine create -d virtualbox \
    --virtualbox-cpu-count &quot;1&quot; \
    --virtualbox-memory &quot;1024&quot; \
    --virtualbox-disk-size &quot;50000&quot; \
    mesos-m1

  echo &quot;---&gt; create mesos-m2&quot;
  docker-machine create -d virtualbox \
    --virtualbox-cpu-count &quot;1&quot; \
    --virtualbox-memory &quot;1024&quot; \
    --virtualbox-disk-size &quot;50000&quot; \
    mesos-m2

  echo &quot;---&gt; create mesos-m3&quot;
  docker-machine create -d virtualbox \
    --virtualbox-cpu-count &quot;1&quot; \
    --virtualbox-memory &quot;1024&quot; \
    --virtualbox-disk-size &quot;50000&quot; \
    mesos-m3
}

create_slaves() {
  echo &quot;---&gt; create slaves&quot;
  echo &quot;---&gt; create mesos-s1&quot;
  docker-machine create -d virtualbox \
    --virtualbox-cpu-count &quot;2&quot; \
    --virtualbox-memory &quot;4092&quot; \
    --virtualbox-disk-size &quot;50000&quot; \
    mesos-s1

  echo &quot;---&gt; create mesos-s2&quot;
  docker-machine create -d virtualbox \
      --virtualbox-cpu-count &quot;2&quot; \
      --virtualbox-memory &quot;4092&quot; \
      --virtualbox-disk-size &quot;50000&quot; \
      mesos-s2
}

create_loadbalancer() {
  echo &quot;---&gt; create loadbalancer&quot;
  echo &quot;---&gt; create mesos-lb1&quot;
  docker-machine create -d virtualbox \
    --virtualbox-cpu-count &quot;1&quot; \
    --virtualbox-memory &quot;1024&quot; \
    --virtualbox-disk-size &quot;50000&quot; \
    mesos-lb1
}
main() {
  clean
  create_masters
  create_slaves
  create_loadbalancer
  echo &quot;done&quot;
}

main

</code></pre><p>After running this script, check the results:</p><pre><code>docker-machine ls | grep virtualbox
mesos-lb1                    -        virtualbox   Running   tcp://192.168.99.105:2376           v1.11.1   
mesos-m1                     -        virtualbox   Running   tcp://192.168.99.100:2376           v1.11.1   
mesos-m2                     -        virtualbox   Running   tcp://192.168.99.101:2376           v1.11.1   
mesos-m3                     -        virtualbox   Running   tcp://192.168.99.102:2376           v1.11.1   
mesos-s1                     -        virtualbox   Running   tcp://192.168.99.103:2376           v1.11.1   
mesos-s2                     -        virtualbox   Running   tcp://192.168.99.104:2376           v1.11.1
</code></pre><p>That was easy!</p><h1 id=run>Run</h1><div class=related><h3>Similar articles:</h3><ul><li><a href=/posts/pentahanl-spring-meetup/>Pentaho NL spring meetup</a></li><li><a href=/posts/jekyll-to-hugo/>Jekyll boooh, hugo yeah!</a></li><li><a href=/posts/2016-04-26-first-meetup-update/>Update: First pentaho nl meetup!</a></li><li><a href=/posts/2016-01-30-first-meetup/>First pentaho nl meetup!</a></li><li><a href=/posts/2015-11-10-pentaho-nl/>Pentaho NL Usergroup!</a></li></ul></div></div></div></section><script src=/js/copycode.js></script><section class=section><div class=container><aside><div id=disqus_thread></div></aside><script type=text/javascript>var disqus_shortname='blijblijblij';function disqus(){var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);}
disqus();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript></div></section><section class=section><div class="container has-text-centered"><p>&copy; <a href=https://github.com/blijblijblij>Rogier Wessel</a> 2020</p></div></section></body></html>